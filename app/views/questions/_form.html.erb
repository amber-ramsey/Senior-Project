<%= form_with(model: question, local: true) do |f| %>
  <%= render 'shared/error_quest' %>

  <div class="col questform">
    <div class="card d-flex border-0 mx-auto">
      <div class="field col-lg-6 col-xxl-5 p-2 mt-1">
        <% if @question.id != nil && @question.picture.attached? %>
          <span style="margin:0 60 0 0"><%= image_tag(@question.display_pic) %></span>
          <%= link_to "Delete Picture", "", class: 'btn-danger my-3 mx-auto', :onclick=>"delete_pic()", data: { confirm: 'Are you sure you want to delete this picture?' } %>
        <% else %>
          <div class="card-body pb-0 pt-3 mb-0">
            <%= f.label "Upload Image (Optional):" %>
            </br>
            <%= f.file_field :picture, accept: 'image/png, image/gif, image/jpeg', class: "w-100 mb-0" %>
          </div>
        <% end %>
      </div>
      <div class="card-body py-2 mt-1">
        <div class="field">
          <%= f.label :query, "Question:"  %>
          <br />
          <%= f.text_area :query, rows: 3, class: "w-100" %>
        </div>
        <div class="field">
          <%= f.label :correct, "Correct Answer: " %>
          <%= f.select :correct, options_for_select([['Choose Answer Choice', 0],['Choice 1', 1], ['Choice 2', 2], ['Choice 3', 3], ['Choice 4', 4], ['Choice 5', 5], ['Choice 6', 6], ['Choice 7', 7], ['Choice 8', 8], ['Choice 9', 9], ['Choice 10', 10]], selected: @question.correct || 0) %>
        </div>
      </div>
    </div>
  </div>
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xxl-5 g-0">
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch1, "Choice 1:" %>
            <br />
            <%= f.text_area :ch1, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch2, "Choice 2:" %>
            <br />
            <%= f.text_area :ch2, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch3, "Choice 3:" %>
            <br />
            <%= f.text_area :ch3, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch4, "Choice 4:" %>
            <br />
            <%= f.text_area :ch4, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch5, "Choice 5:" %>
            <br />
            <%= f.text_area :ch5, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch6, "Choice 6:" %>
            <br />
            <%= f.text_area :ch6, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch7, "Choice 7:" %>
            <br />
            <%= f.text_area :ch7, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch8, "Choice 8:" %>
            <br />
            <%= f.text_area :ch8, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch9, "Choice 9:" %>
            <br />
            <%= f.text_area :ch9, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card border-0 mx-auto">
        <div class="card-body py-1">
          <div class="field">
            <%= f.label :ch10, "Choice 10:" %>
            <br />
            <%= f.text_area :ch10, rows: 2, class: "w-100" %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="d-grid my-2 col-4 mx-auto">
    <%= f.hidden_field :test_id, :value=> params[:test_id] %>
    <%= f.submit "Save Question", class: 'btn-primary' %>
    <% if @question.id != nil %>
      <%= link_to "Delete Question", test_question_path(question), class: 'btn-danger', method: :delete, data: { confirm: 'Are you sure you want to delete this question?' } %>
    <% end %>
  </div>
<% end %>
<script>
  $("#question_picture").bind("change", function() {
    const size_in_megabytes = this.files[0].size/1024/1024;
    if (size_in_megabytes > 5) {
      alert("Maximum file size is 5MB. Please choose a smaller file.");
      $("#question_picture").val("");
    }
  });
</script>